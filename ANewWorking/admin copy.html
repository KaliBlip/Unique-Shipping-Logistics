<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parcel Tracking Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <style>
        .form-group label {
            font-size: 16px;
            font-family: Arial, Helvetica, sans-serif;
        }

        .form-group input,
        .form-group select {
            font-size: 16px;
            font-family: Arial, Helvetica, sans-serif;
        }

        .btn-custom {
            font-size: 16px;
        }
    </style>
</head>

<body>
    <div class="container mt-5">
        <h1 class="mb-4">Parcel Tracking Dashboard</h1>
        <form>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="TrackingIdInp">Tracking ID</label>
                        <input type="text" class="form-control" id="TrackingIdInp" required>
                        <div class="invalid-feedback">Please enter a tracking ID.</div>
                    </div>
                    <div class="form-group">
                        <label for="ParcelNameInp">Name of Parcel</label>
                        <input type="text" class="form-control" id="ParcelNameInp" required>
                        <div class="invalid-feedback">Please enter the name of the parcel.</div>
                    </div>
                    <div class="form-group">
                        <label for="SourceInp">Source</label>
                        <input type="text" class="form-control" id="SourceInp" required>
                        <div class="invalid-feedback">Please enter the source.</div>
                    </div>
                    <div class="form-group">
                        <label for="DestinationInp">Destination</label>
                        <input type="text" class="form-control" id="DestinationInp" required>
                        <div class="invalid-feedback">Please enter the destination.</div>
                    </div>
                    <div class="form-group">
                        <label for="StatusInp">Status</label>
                        <select class="form-control" id="StatusInp" required>
                            <option value="" disabled selected>Select status</option>
                            <option value="Pending">Pending</option>
                            <option value="In Transit">In Transit</option>
                            <option value="Delivered">Delivered</option>
                        </select>
                        <div class="invalid-feedback">Please select a status.</div>
                    </div>
                    <div class="form-group">
                        <label for="LastUpdateInp">Last Update</label>
                        <input type="datetime-local" class="form-control" id="LastUpdateInp" required>
                        <div class="invalid-feedback">Please select the last update time.</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="DispatchDateInp">Date of Dispatch</label>
                        <input type="date" class="form-control" id="DispatchDateInp" required>
                        <div class="invalid-feedback">Please enter the date of dispatch.</div>
                    </div>
                    <div class="form-group">
                        <label for="DeliveryDateInp">Estimated Delivery Date</label>
                        <input type="date" class="form-control" id="DeliveryDateInp" required>
                        <div class="invalid-feedback">Please enter the estimated delivery date.</div>
                    </div>
                    <div class="form-group">
                        <label for="CurrentLocationInp">Current Location</label>
                        <input type="text" class="form-control" id="CurrentLocationInp" required>
                        <div class="invalid-feedback">Please enter the current location.</div>
                    </div>
                    <div class="form-group">
                        <label for="WeightInp">Weight (kg)</label>
                        <input type="number" class="form-control" id="WeightInp" required>
                        <div class="invalid-feedback">Please enter the weight.</div>
                    </div>
                    <div class="form-group">
                        <label for="DimensionsInp">Dimensions (LxWxH cm)</label>
                        <input type="text" class="form-control" id="DimensionsInp" placeholder="Length x Width x Height"
                            required>
                        <div class="invalid-feedback">Please enter the dimensions.</div>
                    </div>
                </div>
            </div>
            <div class="form-group text-center">
                <button type="button" class="btn btn-primary btn-lg btn-custom" id="AddBtn">Add</button>
                <button type="button" class="btn btn-secondary btn-lg btn-custom" id="RetBtn">Retrieve</button>
                <button type="button" class="btn btn-success btn-lg btn-custom" id="UpdBtn">Update</button>
                <button type="button" class="btn btn-danger btn-lg btn-custom" id="DelBtn">Delete</button>
            </div>
        </form>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
        import { getDatabase, ref, child, get, set, update, remove } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAOOj86UOijPcIzB3AgsiGzmMDun-nditA",
            authDomain: "unique-logistix.firebaseapp.com",
            databaseURL: "https://unique-logistix-default-rtdb.firebaseio.com",
            projectId: "unique-logistix",
            storageBucket: "unique-logistix.appspot.com",
            messagingSenderId: "820421076514",
            appId: "1:820421076514:web:8776f14e9c78ff5db78c7b",
            measurementId: "G-6Q2RY0LM09"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase();

        const TrackingIdInp = document.getElementById('TrackingIdInp');
        const ParcelNameInp = document.getElementById('ParcelNameInp');
        const SourceInp = document.getElementById('SourceInp');
        const DestinationInp = document.getElementById('DestinationInp');
        const StatusInp = document.getElementById('StatusInp');
        const DispatchDateInp = document.getElementById('DispatchDateInp');
        const DeliveryDateInp = document.getElementById('DeliveryDateInp');
        const CurrentLocationInp = document.getElementById('CurrentLocationInp');
        const WeightInp = document.getElementById('WeightInp');
        const DimensionsInp = document.getElementById('DimensionsInp');
        const LastUpdateInp = document.getElementById('LastUpdateInp');

        const AddBtn = document.getElementById('AddBtn');
        const RetBtn = document.getElementById('RetBtn');
        const UpdBtn = document.getElementById('UpdBtn');
        const DelBtn = document.getElementById('DelBtn');

        function AddData() {
            set(ref(db, 'shipments/' + TrackingIdInp.value), {
                trackingId: TrackingIdInp.value,
                nameOfParcel: ParcelNameInp.value,
                source: SourceInp.value,
                destination: DestinationInp.value,
                status: StatusInp.value,
                dispatchDate: DispatchDateInp.value,
                deliveryDate: DeliveryDateInp.value,
                currentLocation: CurrentLocationInp.value,
                weight: Number(WeightInp.value),
                dimensions: DimensionsInp.value,
                lastUpdate: LastUpdateInp.value
            })
                .then(() => {
                    alert("Data Added Successfully");
                })
                .catch((error) => {
                    alert("Unsuccessful");
                    console.log(error);
                });
        }

        function RetData() {
            const dbRef = ref(db);
            get(child(dbRef, 'shipments/' + TrackingIdInp.value)).then((snapshot) => {
                if (snapshot.exists()) {
                    TrackingIdInp.value = snapshot.val().trackingId;
                    ParcelNameInp.value = snapshot.val().nameOfParcel;
                    SourceInp.value = snapshot.val().source;
                    DestinationInp.value = snapshot.val().destination;
                    StatusInp.value = snapshot.val().status;
                    DispatchDateInp.value = snapshot.val().dispatchDate;
                    DeliveryDateInp.value = snapshot.val().deliveryDate;
                    CurrentLocationInp.value = snapshot.val().currentLocation;
                    WeightInp.value = snapshot.val().weight;
                    DimensionsInp.value = snapshot.val().dimensions;
                    LastUpdateInp.value = snapshot.val().lastUpdate;
                } else {
                    alert("Parcel does not exist");
                }
            })
                .catch((error) => {
                    alert("Unsuccessful");
                    console.log(error);
                });
        }

        function UpdateData() {
            update(ref(db, 'shipments/' + TrackingIdInp.value), {
                nameOfParcel: ParcelNameInp.value,
                source: SourceInp.value,
                destination: DestinationInp.value,
                status: StatusInp.value,
                dispatchDate: DispatchDateInp.value,
                deliveryDate: DeliveryDateInp.value,
                currentLocation: CurrentLocationInp.value,
                weight: Number(WeightInp.value),
                dimensions: DimensionsInp.value,
                lastUpdate: LastUpdateInp.value
            })
                .then(() => {
                    alert("Data Updated Successfully");
                })
                .catch((error) => {
                    alert("Unsuccessful");
                    console.log(error);
                });
        }

        function DeleteData() {
            remove(ref(db, 'shipments/' + TrackingIdInp.value))
                .then(() => {
                    alert("Data Deleted Successfully");
                })
                .catch((error) => {
                    alert("Unsuccessful");
                    console.log(error);
                });
        }

        AddBtn.addEventListener('click', AddData);
        RetBtn.addEventListener('click', RetData);
        UpdBtn.addEventListener('click', UpdateData);
        DelBtn.addEventListener('click', DeleteData);

        // Bootstrap form validation
        (function () {
            'use strict'
            window.addEventListener('load', function () {
                var forms = document.getElementsByClassName('needs-validation')
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault()
                            event.stopPropagation()
                        }
                        form.classList.add('was-validated')
                    }, false)
                })
            }, false)
        })()
    </script>
</body>

</html>